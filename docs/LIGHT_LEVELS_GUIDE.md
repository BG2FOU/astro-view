# 光害等级完整指南

## 波特尔光害等级（Bortle Scale）

波特尔光害等级从 1 到 9，数字越小表示光害越轻，观星条件越好。

| 输入值 | 显示文本 | 说明 |
|--------|--------|------|
| `1` | 1级 / 极限星等 7.6~8.0 | 最佳观星地，可见极限星等最高 |
| `2` | 2级 / 极限星等 7.1~7.5 | 极优秀，肉眼可见银河 |
| `3` | 3级 / 极限星等 6.6~7.0 | 优秀，适合天文摄影 |
| `4` | 4级 / 极限星等 6.1~6.5 | 很好，可见深空天体 |
| `5` | 5级 / 极限星等 5.6~6.0 | 良好，中等光害 |
| `6` | 6级 / 极限星等 5.1~5.5 | 中等，城市边缘 |
| `7` | 7级 / 极限星等 4.6~5.0 | 较差，郊外区域 |
| `8` | 8级 / 极限星等 4.1~4.5 | 很差，受光污染 |
| `9` | 9级 / 极限星等 4.0 | 最差，严重光污染 |

## 中国暗夜环境等级

中国暗夜环境等级从 1 到 5+，配合颜色标记帮助用户快速识别。

| 输入值 | 显示文本 | 颜色标记 | 说明 |
|--------|--------|--------|------|
| `1` | 1级 (优秀) | 🟢 绿色 | 最佳暗夜环保区 |
| `2` | 2级 (良好) | 🟢 绿色 | 良好的观星地 |
| `3` | 3级 (一般) | 🟡 黄色 | 一般光害程度 |
| `4` | 4级 (较差) | 🟠 橙色 | 较强的光污染 |
| `5` | 5级 (严重) | 🔴 红色 | 严重的光污染 |
| `5+` | 5级+ (极度严重) | 🔴 红色 | 极度严重的光污染 |

## 使用示例

### 在 JSON 中添加观星地

```json
{
  "observatories": [
    {
      "id": "test-location-1",
      "name": "测试地点 1 - 最佳条件",
      "latitude": 45.31119,
      "longitude": 127.588019,
      "coordinates": "127.588019°E,45.311199°N",
      "bortle": "1",
      "standardLight": "1",
      "sqm": "21.8",
      "climate": "晴朗率高",
      "accommodation": "民宿多",
      "notes": "波特尔1级，中国1级 - 绝佳的观星地"
    },
    {
      "id": "test-location-2",
      "name": "测试地点 2 - 中等条件",
      "latitude": 36.251,
      "longitude": 117.102,
      "coordinates": "117.102°E,36.251°N",
      "bortle": "5",
      "standardLight": "3",
      "sqm": "20.5",
      "climate": "四季分明",
      "accommodation": "酒店众多",
      "notes": "波特尔5级，中国3级 - 中等光害"
    },
    {
      "id": "test-location-3",
      "name": "测试地点 3 - 城市边缘",
      "latitude": 39.904,
      "longitude": 116.408,
      "coordinates": "116.408°E,39.904°N",
      "bortle": "8",
      "standardLight": "5+",
      "sqm": "18.0",
      "climate": "晴天较少",
      "accommodation": "城市酒店",
      "notes": "波特尔8级，中国5+级 - 严重光污染"
    }
  ]
}
```

### 页面显示效果

点击地图上的标记，信息面板会展示：

```
地点名称: 测试地点 1 - 最佳条件
坐标: 45.3112°N, 127.5880°E
波特尔光害等级: 1级 / 极限星等 7.6~8.0
中国暗夜环境等级: [绿色标签] 1级 (优秀)
SQM值: 21.8 mag/arcsec²
气候情况: 晴朗率高
住宿情况: 民宿多
备注: 波特尔1级，中国1级 - 绝佳的观星地
```

## 技术实现

### 映射函数

在 `src/app.js` 中定义了两个映射表：

```javascript
// 波特尔光害等级映射表
const BORTLE_LEVELS = {
  '1': '1级 / 极限星等 7.6~8.0',
  '2': '2级 / 极限星等 7.1~7.5',
  // ... 更多定义
};

// 中国暗夜环境等级映射表（包含颜色）
const STANDARD_LIGHT_LEVELS = {
  '1': { label: '1级 (优秀)', color: '#27ae60' },      // 绿色
  '2': { label: '2级 (良好)', color: '#27ae60' },      // 绿色
  '3': { label: '3级 (一般)', color: '#f39c12' },      // 黄色
  '4': { label: '4级 (较差)', color: '#e67e22' },      // 橙色
  '5': { label: '5级 (严重)', color: '#e74c3c' },      // 红色
  '5+': { label: '5级+ (极度严重)', color: '#e74c3c' } // 红色
};
```

### 自动转换

当加载观星地信息时，`showObservatoryInfo()` 函数会自动：
1. 查询 `BORTLE_LEVELS` 表获取完整文本
2. 查询 `STANDARD_LIGHT_LEVELS` 表获取标签和颜色
3. 在信息面板中显示彩色标记

## 常见问题

**Q: 如果我输入不存在的等级值会怎样？**  
A: 程序会显示原始输入值（例如 `10 级`）。建议只使用上表中的值。

**Q: 能否自定义颜色？**  
A: 可以，编辑 `src/app.js` 中的 `STANDARD_LIGHT_LEVELS` 对象，修改 `color` 属性的十六进制值。

**Q: 添加新的等级怎么做？**  
A: 在相应的映射表中添加新条目即可，格式参考上面的示例。

## 数据更新

修改 `public/data/observatories.json` 文件后，启用 "自动刷新" 功能，30 秒内会自动加载新数据。
